

X=[2 0 0 -2; 0 1 -1 0];
plot(X(1,1),X(2,1),'*',X(1,2),X(2,2),'*',X(1,3),X(2,3),'*',X(1,4),X(2,4),'*');
axis([-3 3 -2 2])
title('original set')
pause
sf=2;
S=[sf 0;0 sf];

ang=pi/6;
a1=cos(ang);
a2=sin(ang);
R=[a1 a2; -a2 a1];
T0=[3 3 3 3;4 4 4 4];

Y=R*S*X+T0
plot(Y(1,1),Y(2,1),'*',Y(1,2),Y(2,2),'*',Y(1,3),Y(2,3),'*',Y(1,4),Y(2,4),'*');
axis([-4 8 -0 8])
title('transformed  set')
pause

% Y = 6.4641    4.0000    2.0000   -0.4641
%     2.0000    5.7321    2.2679    6.0000

M=mean(Y,2)

% M =  3
%      4

M0=[M(1) M(1) M(1) M(1) ;M(2) M(2) M(2) M(2) ]
C=cov(Y(1,:),Y(2,:))

% C =  8.6667   -3.4641
%     -3.4641    4.6667


[V,D] = eigs(C)

% V =-0.8660   -0.5000
%     0.5000   -0.8660


% D = 10.6667     0
%      0        2.6667

compass([V(1,1),V(2,1)],[V(1,2),V(2,2)]);
% CV=VD
XX=V'*(Y-M0)

plot(XX(1,1),XX(2,1),'*',XX(1,2),XX(2,2),'*',XX(1,3),XX(2,3),'*',XX(1,4),XX(2,4),'*');
axis([-6 6 -4 4])
title('result')
pause

% XX = -4.0000   -0.0000    0.0000    4.0000
%       0.0000   -2.0000    2.0000   -0.0000

CC=cov(XX(1,:),XX(2,:))

% CC = 10.6667   -0.0000
%      -0.0000    2.6667
